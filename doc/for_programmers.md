# basics

Filter Spirit is written completely in ISO-compliant C++17.

Most of the program logic is realized using [monadic](https://en.wikipedia.org/wiki/Monad_(functional_programming)) interfaces (as opposed to traditional object oriented approach using abstract classes). In C++ this means a lot of optionals, variants, tuples and (generic) lambdas.

# program structure

There exist 2 code directories:

- `src` - everything needed to build the main executable
- `test` - test-runner executable, depends on files in `src`

`src` subdirectories (each module has a separate namespace):

- `utility` - can be used anywhere. Contains STL helpers and Better Enum library.
- `log` - logger interface and string utility functions, used in many other modules
- `network` - Boost Beast + Boost ASIO stuff
- `lang` - all stuff that is related to FS language (keywords, types etc)
- `parser` - parser implementation using Boost Spirit X3. [Short article](https://en.wikipedia.org/wiki/Spirit_Parser_Framework) on how it works.
- `compiler` - code that takes AST generated by the parser, item price data and outputs a ready-to-generate filter spec
- `generator` - creates final filter file
- `itemdata` - code for handling item prices; likely going to be refactored/split into lang/network modules
- `core` - main executable argument parser, invokes all the things

No module may include or use code from other module's `detail` namespace.

There are (and should not be) circular dependencies. The flow of the code is relatively simple:

```
 lang      network
   |          |
   v          v
 parser    itemdata
   |       /
   v     |/_
compiler
   |
   v
generator
```
